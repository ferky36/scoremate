<!DOCTYPE html>
<html lang="id">
<head>
  <link rel="manifest" href="pwa-manifest.webmanifest?v=2025-10-13" />
  <meta name="theme-color" content="#4f46e5" />
  <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192.png" />
  <!-- iOS startup images (optional, add actual files under /splash) -->
  <link rel="apple-touch-startup-image" href="splash/iphone-1284x2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/iphone-1170x2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/iphone-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/iphone-828x1792.png"  media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/iphone-750x1334.png"  media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/ipad-2048x2732.png"   media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/ipad-1668x2388.png"   media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="splash/ipad-1536x2048.png"   media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' blob: data: https://*.supabase.co; connect-src 'self' https://*.supabase.co wss://*.supabase.co;">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Padel-NBC</title>
  <link rel="stylesheet" href="styles.css?v=2025-08-29" />
  <link rel="stylesheet" href="match-recap.css?v=2025-09-22" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { darkMode: 'class' };</script>
  <script src="scripts/lang.js"></script>
  <script>
    // shim: ensure setAppTitle exists early to avoid ReferenceError from other scripts
    if (typeof window.setAppTitle !== 'function') {
      window.setAppTitle = function(title){
        try{
          if (title){
            const el = document.getElementById('appTitle');
            if (el) el.textContent = title;
            document.title = (title ? title + ' – ' : '') + 'Mix Americano';
          } else {
            const el = document.getElementById('appTitle'); if (el) el.textContent = 'Mix Americano';
            document.title = 'Mix Americano';
          }
        }catch(e){ /* noop */ }
      };
    }
  </script>
</head>
<body class="bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100">
  <!-- App Splash (soft gradient overlay). Auto hides after window load. -->
  <div id="appSplash" class="app-splash">
    <div class="app-splash-center">
      <img src="icons/icon-192.png" alt="App" />
    </div>
  </div>
  <!-- HEADER -->
  <header class="sticky top-0 z-10 shadow-sm">
    <div class="bg-gradient-to-r from-purple-600 via-fuchsia-600 to-indigo-600 text-white rounded-b-3xl">
      <div class="mx-auto max-w-7xl px-3 py-1 md:py-3 flex flex-col gap-2">
        <div class="flex items-start gap-3">
          
          <div class="h-14 w-14 md:h-16 md:w-16 rounded-2xl bg-white/20 grid place-items-center shadow"><span class="text-2xl md:text-3xl">🎾</span></div>
          <div class="flex-1 min-w-0">
            <div class="flex flex-col md:flex-row md:items-center md:gap-3">
              <h1 id="appTitle" class="text-2xl md:text-3xl font-bold leading-tight">Event Padel/Tennis</h1>
              <div id="hdrChips" class="mt-2 md:mt-0 md:ml-auto flex flex-wrap items-center gap-2 justify-end">
                <span id="chipDate" class="chip">
                  <svg class="chip-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                  <span id="chipDateText">—</span>
                </span>
                <span id="chipLoc" class="chip hidden">
                  <svg class="chip-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13S3 17 3 10a9 9 0 1 1 18 0Z"/><circle cx="12" cy="10" r="3"/></svg>
                  <a id="chipLocLink" target="_blank" rel="noopener noreferrer"></a>
                  <span id="chipLocText"></span>
                </span>
                <span id="chipCount" class="chip">
                  <svg class="chip-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                  <span id="chipCountText">0 pemain</span>
                </span>
              </div>
              <button id="langToggle" class="lang-toggle" aria-label="Toggle language">
                <span class="flag id-flag" aria-label="Indonesia">
                  <svg viewBox="0 0 3 2" class="flag-svg" role="img" aria-hidden="true" preserveAspectRatio="xMidYMid meet">
                    <rect width="3" height="1" y="0" fill="#e70011"></rect>
                    <rect width="3" height="1" y="1" fill="#ffffff"></rect>
                  </svg>
                </span>
                <span class="flag en-flag" aria-label="United Kingdom">
                  <svg viewBox="0 0 3 2" class="flag-svg" role="img" aria-hidden="true" preserveAspectRatio="xMidYMid meet">
                    <defs>
                      <clipPath id="gb-clip-3x2"><rect width="3" height="2" rx="0.1" ry="0.1"></rect></clipPath>
                    </defs>
                    <g clip-path="url(#gb-clip-3x2)">
                      <rect width="3" height="2" fill="#012169"></rect>
                      <path d="M0 0 L3 2 M3 0 L0 2" stroke="#fff" stroke-width="0.35"></path>
                      <path d="M0 0 L3 2 M3 0 L0 2" stroke="#c8102e" stroke-width="0.22"></path>
                      <path d="M1.5 0 v2 M0 1 h3" stroke="#fff" stroke-width="0.6"></path>
                      <path d="M1.5 0 v2 M0 1 h3" stroke="#c8102e" stroke-width="0.36"></path>
                    </g>
                  </svg>
                </span>
              </button>
              <button id="btnTheme" class="px-3 h-[42px] rounded-xl bg-white/20 text-white font-semibold shadow hover:bg-white/30" title="Toggle Dark Mode">🌙/☀️</button>
              <button id="btnViewStats" class="chip hidden" title="Lihat statistik saya" data-i18n-title="stats.viewMyStats">
                <svg class="chip-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="M7 14l3-3 2 2 5-5"/></svg>
              </button>
              <span id="chipRole" class="chip hidden">
                <svg class="chip-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M19 8v6"/><path d="M22 11h-6"/></svg>
                <span id="chipRoleText">-</span>
              </span>
              <button id="btnHdrControlsToggle" class="hidden md:inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/20 text-white shadow hover:bg-white/30" title="Tampilkan kontrol">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-5 h-5"><path stroke-width="1.8" stroke-linecap="round" d="M4 7h16M4 12h16M4 17h16"/></svg>
              </button>
              <button id="btnInstallAppHdr" class="hidden px-3 py-2 rounded-xl bg-white/20 text-white font-semibold shadow hover:bg-white/30" title="Install aplikasi ke perangkat">Install App</button>
            </div>
          </div>
        </div>
        </div>

        <!-- tombol MENU hanya HP -->
        <div class="flex gap-2 md:hidden">
          <button id="btnHdrMenu" class="px-3 py-2 rounded-xl bg-white/20 text-white font-semibold shadow hover:bg-white/30">☰ Menu</button>
        </div>

        <!-- panel kontrol: hidden di HP, tampil di ≥md -->
        <div id="hdrControlsWrap" class="mx-auto max-w-7xl px-4 py-1 md:py-1 flex flex-col gap-2 collapsible default-collapsed">
        <div id="hdrControls" class="md:flex hdr-mobile-panel items-center w-full md:w-auto mt-1 md:mt-1 justify-end">
          <button id="btnSave" class="px-4 py-2 rounded-xl bg-white text-indigo-700 font-semibold shadow hover:opacity-90">💾 Save</button>
          <!-- removed: dropdown Pilih tanggal -->
          <!-- <button id="btnImportJSON" class="px-3 py-2 rounded-lg bg-emerald-600 text-white font-semibold shadow hover:opacity-90">Load JSON File</button> -->
          <button id="btnMakeEventLink"
                  class="px-3 py-2 rounded-xl bg-emerald-600 text-white font-semibold shadow hover:opacity-90">
            🔗 Buat/Cari Event
          </button>
          <button id="btnShareEvent"
                  class="px-3 py-2 rounded-xl bg-indigo-600 text-white font-semibold shadow hover:opacity-90">
            Share / Undang
          </button>
          <!-- New Location for Leave/Join Player Button -->
          <button id="btnJoinLeaveEvent" class="px-3 py-2 rounded-xl bg-emerald-600 text-white font-semibold shadow hover:opacity-90 hidden">
            Join Event
          </button>
          <input id="fileInputJSON" type="file" accept="application/json" class="hidden" />
          <button id="btnReport" class="px-3 py-2 rounded-xl bg-white text-indigo-700 font-semibold shadow hover:opacity-90">
            📊 Report
          </button>
          <button id="btnCashflow" type="button" class="hidden px-3 py-2 rounded-xl bg-white text-indigo-700 font-semibold shadow hover:opacity-90">Cashflow</button>
          <!-- Removed btnLeaveEvent (Keluar Event) as per request -->
        </div>
      </div>
    </div>

    <!-- FILTER / JADWAL -->
    <div class="bg-white/90 dark:bg-gray-800/90 backdrop-blur border-b border-gray-200 dark:border-gray-700 hidden">
      <!-- tombol Filter di HP -->
      <div class="px-4 pb-2">
        <button id="btnFilterToggle"
          class="w-full md:w-auto px-3 py-2 rounded-xl bg-white/20 dark:bg-gray-700
                text-gray-900 dark:text-white font-semibold shadow hover:bg-white/30
                flex items-center justify-center gap-2">
          <span id="filterChevron">▾</span>
          <span>Filter / Jadwal</span>
        </button>
      </div>

      <!-- Panel Filter: hidden di HP, grid di ≥md -->
      <div id="filterPanel" class="collapsible default-collapsed max-w-7xl mx-auto px-4 pb-4
            grid filter-grid">
        <div class="filter-field filter-field--half filter-field-date">
          <label class="filter-label block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="filter.date">Tanggal</label>
          <input id="sessionDate" type="date" class="filter-input border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100">
        </div>
        <div class="filter-field filter-field--half filter-field-time">
          <label class="filter-label block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="filter.start">Mulai</label>
          <input id="startTime" type="time" class="filter-input border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" value="19:00">
        </div>
        <div class="filter-field filter-field--half filter-field-minutes">
          <label class="filter-label block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="filter.minutes">Menit/Match</label>
          <input id="minutesPerRound" type="number" min="5" class="filter-input border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" value="12">
        </div>
        <div class="filter-field filter-field--half filter-field-break">
          <label class="filter-label block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="filter.break">
            Jeda/Match (menit)
          </label>
          <div class="filter-inline">
            <input id="breakPerRound" type="number" min="0" value="1"
                  class="filter-input filter-input--compact border rounded-xl px-3 py-2 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
            <label class="filter-checkbox inline-flex items-center gap-2 text-sm text-gray-700 dark:text-gray-200">
              <input id="showBreakRows" type="checkbox" class="accent-indigo-600" checked>
              <span data-i18n="filter.showBreakRows">Tampilkan baris jeda</span>
            </label>
          </div>
        </div>
        <div class="filter-field filter-field--half filter-field-round">
          <label class="filter-label block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="filter.rounds">Match/Lapangan</label>
          <input id="roundCount" type="number" min="1" class="filter-input border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" value="10">
        </div>
        <!-- panel PEMAIN collapsible -->
        <div class="filter-field filter-field--full">
          <div class="rounded-2xl bg-gradient-to-r from-purple-600 to-indigo-600 dark:from-indigo-700 dark:to-indigo-800 text-white px-4 py-3 flex items-center justify-between gap-3 flex-wrap sm:flex-nowrap relative">
            <div class="flex items-center gap-3 flex-1 min-w-[180px]">
              <button id="btnCollapsePlayers" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-indigo-800/70 hover:bg-indigo-900 transition text-sm font-semibold shadow" data-i18n="players.collapse">
                <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-white/15 text-white gap-[2px]">
                  <svg id="playersArrowDown" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                  </svg>
                  <svg id="playersArrowUp" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" />
                  </svg>
                </span>
                <span class="text-base font-semibold">Manajemen Pemain</span>
              </button>
              <p class="hidden md:block text-indigo-100 text-sm leading-snug" data-i18n="players.collapseHint">Kelola daftar, gender, level, dan status bayar pemain.</p>
            </div>
            <div class="relative flex items-center gap-2 justify-end">
              <button id="playersActionsToggle" class="md:hidden p-2 rounded-full hover:bg-indigo-600/60 focus:outline-none focus:ring-2 focus:ring-white/50" aria-label="Menu pemain">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="6" r="1.5" />
                  <circle cx="12" cy="12" r="1.5" />
                  <circle cx="12" cy="18" r="1.5" />
                </svg>
              </button>
              <div id="playersActions" class="hidden md:flex md:items-center md:gap-2 flex-col md:flex-row absolute md:static right-0 top-[calc(100%+10px)] md:top-auto md:translate-y-0 translate-y-1 z-10 md:z-auto bg-white text-gray-800 md:bg-transparent md:text-white rounded-xl shadow-2xl md:shadow-none border border-gray-100 md:border-0 overflow-hidden min-w-[210px] md:min-w-0 text-left">
                <button id="btnPasteText" class="w-full md:w-auto px-4 py-2 text-sm font-semibold hover:bg-gray-50 md:hover:bg-indigo-500/60 transition text-left md:text-center" data-i18n="players.editText">Edit sebagai teks</button>
                <button id="btnApplyPlayerTemplate" class="w-full md:w-auto px-4 py-2 text-sm font-semibold hover:bg-gray-50 md:hover:bg-indigo-500/60 transition text-left md:text-center" data-i18n="players.applyTemplate">
                  Apply Template Pemain
                </button>
                <button id="btnClearPlayers" class="w-full md:w-auto px-4 py-2 text-sm font-semibold text-red-600 md:text-white hover:bg-gray-50 md:hover:bg-red-500/70 transition text-left md:text-center" data-i18n="players.clear">Kosongkan</button>
              </div>
            </div>
          </div>
          <div id="playersPanel" class="mt-3 bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-700 p-4 hidden">
            <div id="playersToolbar" class="flex flex-col sm:flex-row gap-3 sm:items-center mb-3">
              <input id="newPlayer" placeholder="Nama pemain..." data-i18n-placeholder="players.new.placeholder" class="flex-1 border rounded-lg px-3 py-3 bg-white dark:bg-gray-800 dark:border-gray-700 shadow-sm focus:ring-2 focus:ring-indigo-400">
              <button id="btnAddPlayer" class="px-4 py-3 rounded-lg bg-indigo-600 text-white font-semibold flex items-center justify-center gap-2 shadow hover:bg-indigo-700" data-i18n="players.add">
                <span class="hidden sm:inline">Tambah</span>
                <span class="sm:hidden" aria-hidden="true">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5Z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 21a7.5 7.5 0 0 1 15 0"/>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 8h4M21 6v4"/>
                  </svg>
                </span>
              </button>
            </div>
            <div id="playerListContainer" class="mt-2">
              <ul id="playersList" class="min-h-[44px] grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"></ul>
            </div>
            <div id="playersWarnings" class="text-xs mt-3 text-amber-600 dark:text-amber-300"></div>
            <div id="textModal" class="hidden mt-4 rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 p-3 space-y-3">
              <textarea id="playersText" rows="6" class="w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" placeholder="Satu nama per baris" data-i18n-placeholder="players.text.placeholder"></textarea>
              <div class="flex flex-wrap gap-2">
                <button id="btnApplyText" class="px-3 py-2 rounded-lg bg-emerald-600 text-white font-semibold shadow hover:bg-emerald-700" data-i18n="players.applyText">Terapkan</button>
                <button id="btnCancelText" class="px-3 py-2 rounded-lg border bg-white dark:bg-gray-800 dark:border-gray-700 font-semibold hover:bg-gray-50 dark:hover:bg-gray-700" data-i18n="players.cancel">Batal</button>
              </div>
            </div>
          </div>
        </div> <!-- /panel pemain -->
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-7xl mx-auto p-4 md:p-6 space-y-6">
    <section class="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3">
        <select id="pairMode" class="px-3 py-2 rounded-xl border shadow text-sm dark:bg-gray-900 dark:border-gray-700">
          <option value="free" data-i18n="pairing.mode.free">Mode Pairing: Bebas</option>
          <option value="mixed" data-i18n="pairing.mode.mixed">Mixed Gender (M+F vs M+F)</option>
          <option value="lvl_bal" data-i18n="pairing.mode.balance">Level Balance (beg+pro vs beg+pro)</option>
          <option value="lvl_same" data-i18n="pairing.mode.same">Level Sama (beg vs beg, pro vs pro)</option>
        </select>

        <button id="btnApplyPlayersActive"
                class="px-4 py-2 rounded-xl bg-indigo-600 text-white shadow hover:bg-indigo-700">
          <span data-i18n="controls.applyActive">Terapkan (Lapangan Aktif) & Auto Pasangan</span>
        </button>

        <button id="btnResetActive"
                class="px-4 py-2 rounded-xl border shadow hover:bg-gray-50 dark:hover:bg-gray-700 dark:border-gray-700">
          <span data-i18n="controls.resetActive">♻️ Reset Lapangan Aktif</span>
        </button>

        <!-- Single clear button -->
        <button id="btnClearScoresActive"
                class="px-4 py-2 rounded-xl border shadow hover:bg-gray-50 dark:hover:bg-gray-700 dark:border-gray-700">
          <span>Clear Score</span>
        </button>
      </div>

      <div id="globalInfo" class="text-sm text-gray-600 dark:text-gray-300 mt-3"></div>
    </section>

    <section class="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow" id="toolbarSection">
      <!-- Toolbar Lapangan (dinamis) -->
      <div class="border-b border-gray-200 dark:border-gray-700 flex items-center gap-2 mb-3 overflow-x-auto" id="courtsToolbar">
        <!-- tombol-tombol lapangan akan dirender via JS -->
        <button id="btnAddCourt"
                class="ml-auto px-3 py-1.5 rounded-lg border dark:border-gray-700 text-sm hover:bg-gray-50 dark:hover:bg-gray-700">
          <span data-i18n="controls.addCourt">＋ Tambah Lapangan</span>
        </button>
      </div>

      <!-- Container tempat render lapangan aktif -->
      <div id="courtContainer" class="space-y-3"></div>

      <div id="errors" class="mt-3"></div>

    </section>

    <section class="bg-white dark:bg-gray-800 p-4 rounded-2xl shadow">
      <h2 class="text-lg md:text-xl font-semibold mb-2" data-i18n="standings.title">Klasemen</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm dark-table" id="standings">
          <thead>
            <tr class="text-left border-b border-gray-200 dark:border-gray-700">
              <th class="py-2 pr-4" data-i18n="standings.rank">Rank</th>
              <th class="py-2 pr-4" data-i18n="standings.player">Pemain</th>
              <th class="py-2 pr-4" data-i18n="standings.total">Total</th>
              <th class="py-2 pr-4" data-i18n="standings.diff">Selisih</th>
              <th class="py-2 pr-4" data-i18n="standings.w">W</th>
              <th class="py-2 pr-4" data-i18n="standings.l">L</th>
              <th class="py-2 pr-4" data-i18n="standings.d">D</th>
              <th class="py-2 pr-4" data-i18n="standings.winrate">WinRate</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <!-- Info Ranking -->
      <div class="mt-4 p-4 rounded-xl bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-gray-800 dark:to-gray-700 border border-indigo-100 dark:border-gray-600 text-sm text-gray-700 dark:text-gray-200 shadow-sm">
        <h4 class="font-semibold mb-2 text-indigo-700 dark:text-indigo-300" data-i18n="standings.rules.title">📊 Aturan Ranking</h4>
        <ol class="list-decimal ml-5 space-y-1">
          <li><strong data-i18n="standings.rules.headingTotal">Total </strong> <span data-i18n="standings.rules.total">— pemain dengan poin total lebih tinggi berada di peringkat lebih atas.</span></li>
          <li><strong data-i18n="standings.rules.headingDiff">Selisih </strong> <span data-i18n="standings.rules.diff">— jika Total sama, peringkat ditentukan oleh selisih skor (point for – point against). Lebih besar → lebih tinggi.</span></li>
          <li><strong data-i18n="standings.rules.headingWins">Menang </strong> <span data-i18n="standings.rules.wins">— jika Total & Selisih sama, dilihat jumlah kemenangan (W). Lebih banyak → lebih tinggi.</span></li>
          <li><span data-i18n="standings.rules.alphabet">Jika semua sama → diurutkan alfabetis nama pemain.</span></li>
        </ol>
      </div>
    </section>
  </main>
  <div id="reportModal" class="fixed inset-0 bg-black/40 hidden z-50">
    <div class="mx-auto mt-16 max-w-5xl bg-white dark:bg-gray-800 rounded-2xl shadow p-4 md:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg md:text-xl font-semibold" data-i18n="report.title">Report Klasemen (Multi Tanggal)</h3>
        <button id="btnReportClose" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="report.close">Tutup</button>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4">
        <div>
          <label class="block text-[11px] uppercase font-semibold text-gray-500 dark:text-gray-300" data-i18n="report.from">Dari</label>
          <input id="repFrom" type="date"
            class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700">
        </div>
        <div>
          <label class="block text-[11px] uppercase font-semibold text-gray-500 dark:text-gray-300" data-i18n="report.to">Sampai</label>
          <input id="repTo" type="date"
            class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700">
        </div>
        <div>
          <label class="block text-[11px] uppercase font-semibold text-gray-500 dark:text-gray-300" data-i18n="report.court">Lapangan</label>
          <select id="repCourt"
            class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700">
            <option value="both" data-i18n="report.court.both">Keduanya</option>
            <option value="1" data-i18n="report.court.one">Hanya Lap 1</option>
            <option value="2" data-i18n="report.court.two">Hanya Lap 2</option>
          </select>
        </div>
        <div class="flex items-end">
          <button id="btnRunReport"
            class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white" data-i18n="report.run">Tampilkan</button>
        </div>
      </div>

      <div id="reportSummary" class="text-sm text-gray-600 dark:text-gray-300 mb-3"></div>

      <div class="overflow-x-auto court-wrapper">
        <table class="min-w-full text-sm dark-table" id="reportTable">
          <thead>
            <tr class="text-left border-b border-gray-200 dark:border-gray-700">
              <th class="py-2 pr-4" data-i18n="standings.rank">Rank</th>
              <th class="py-2 pr-4" data-i18n="standings.player">Pemain</th>
              <th class="py-2 pr-4" data-i18n="report.main">Main</th>
              <th class="py-2 pr-4" data-i18n="standings.total">Total</th>
              <th class="py-2 pr-4" data-i18n="standings.diff">Selisih</th>
              <th class="py-2 pr-4" data-i18n="standings.w">W</th>
              <th class="py-2 pr-4" data-i18n="standings.l">L</th>
              <th class="py-2 pr-4" data-i18n="standings.d">D</th>
              <th class="py-2 pr-4" data-i18n="standings.winrate">WinRate</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="mt-4 flex justify-end">
        <button id="btnExportReportExcel"
          class="px-3 py-2 rounded-xl border dark:border-gray-700">
          <span data-i18n="report.exportExcel">Export Excel</span>
        </button>

      </div>
    </div>
  </div>
  <!-- Modal: Kas Event -->
  <div id="cashModal" class="fixed inset-0 bg-black/40 hidden z-50">
    <div class="absolute inset-0" data-cash-act="close"></div>
    <div class="relative mx-auto mt-10 w-[95%] max-w-5xl rounded-2xl bg-white dark:bg-gray-800 border dark:border-gray-700 shadow p-4 md:p-6 md:max-h-[85vh] md:overflow-y-auto">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg md:text-xl font-semibold">
          <span data-i18n="cash.title">Cashflow Event</span>
          <span id="cashEventInfo" class="ml-2 text-sm font-normal text-gray-600 dark:text-gray-300"></span>
        </h3>
        <div class="flex items-center gap-2">
          <button id="btnCashExportExcel" class="px-3 py-1.5 rounded-lg bg-emerald-600 text-white text-sm hover:opacity-90" data-i18n="cash.exportExcel">Export Excel</button>
          <button id="btnCashExportPDF" class="px-3 py-1.5 rounded-lg bg-indigo-600 text-white text-sm hover:opacity-90" data-i18n="cash.exportPDF">Export PDF</button>
          <button id="btnCashClose" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="cash.close">Tutup</button>
        </div>
      </div>
      <!-- Filter Tanggal (opsional, untuk menampilkan lintas event) -->
      <div class="rounded-xl border dark:border-gray-700 p-3 mb-4">
        <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-3">
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 w-full md:w-auto">
            <div>
              <label class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.start">Start</label>
              <input type="date" id="cashStart" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" />
            </div>
            <div>
              <label class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.end">End</label>
              <input type="date" id="cashEnd" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" />
            </div>
          </div>
          <div class="flex items-center gap-2">
            <button id="btnCashApplyRange" class="px-3 py-2 rounded-lg bg-indigo-600 text-white" data-i18n="cash.applyRange">Terapkan</button>
            <button id="btnCashClearRange" class="px-3 py-2 rounded-lg border dark:border-gray-700" data-i18n="cash.clearRange">Reset</button>
          </div>
        </div>
        <div class="mt-2 text-xs text-gray-600 dark:text-gray-300" data-i18n="cash.rangeHint">
          Isi tanggal Start–End untuk melihat kas dari semua event dalam rentang tersebut (Cloud saja).
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4">
        <div class="rounded-xl border dark:border-gray-700 p-3">
          <div class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.sumIn">Uang Masuk</div>
          <div id="cashSumIn" class="text-xl font-bold text-emerald-600">Rp0</div>
        </div>
        <div class="rounded-xl border dark:border-gray-700 p-3">
          <div class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.sumOut">Uang Keluar</div>
          <div id="cashSumOut" class="text-xl font-bold text-red-500">Rp0</div>
        </div>
        <div class="rounded-xl border dark:border-gray-700 p-3">
          <div class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.sumRemain">Sisa</div>
          <div id="cashSumRemain" class="text-xl font-bold">Rp0</div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <section class="rounded-xl border dark:border-gray-700 p-3">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-semibold" data-i18n="cash.inTitle">Uang Masuk</h4>
            <div class="flex items-center gap-2">
              <span id="cashCountIn" class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.inRows">0 baris</span>
              <button id="btnCashAddIn" class="px-2 py-1 rounded-lg border dark:border-gray-700 text-sm" data-i18n="cash.inAdd">Tambah</button>
            </div>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full text-sm dark-table">
              <thead>
                <tr class="text-left border-b border-gray-200 dark:border-gray-700">
                  <th class="py-2 pr-2" data-i18n="cash.table.source">Source</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.amount">Amount</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.pax">Pax</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.total">Total</th>
                  <th class="py-2 pr-2"></th>
                </tr>
              </thead>
              <tbody id="cashTbodyIn"></tbody>
            </table>
          </div>
        </section>
        <section class="rounded-xl border dark:border-gray-700 p-3">
          <div class="flex items-center justify-between mb-2">
            <h4 class="font-semibold" data-i18n="cash.outTitle">Uang Keluar</h4>
            <div class="flex items-center gap-2">
              <span id="cashCountOut" class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.outRows">0 baris</span>
              <button id="btnCashAddOut" class="px-2 py-1 rounded-lg border dark:border-gray-700 text-sm" data-i18n="cash.outAdd">Tambah</button>
            </div>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full text-sm dark-table">
              <thead>
                <tr class="text-left border-b border-gray-200 dark:border-gray-700">
                  <th class="py-2 pr-2" data-i18n="cash.table.items">Items</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.amount">Amount</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.pax">Pax</th>
                  <th class="py-2 pr-2 text-right" data-i18n="cash.table.total">Total</th>
                  <th class="py-2 pr-2"></th>
                </tr>
              </thead>
              <tbody id="cashTbodyOut"></tbody>
            </table>
          </div>
        </section>
      </div>
    </div>
  </div>
  <!-- Submodal: Tambah/Edit Kas -->
  <div id="cashFormModal" class="fixed inset-0 bg-black/40 hidden z-[60]">
    <div class="absolute inset-0" data-cashform-act="close"></div>
    <div class="relative mx-auto mt-16 w-[92%] max-w-md rounded-2xl bg-white dark:bg-gray-800 border dark:border-gray-700 shadow p-4 md:p-6">
      <h3 id="cashFormTitle" class="text-lg font-semibold mb-2" data-i18n="cash.form.title">Tambah</h3>
      <form id="cashForm" class="space-y-3">
        <div>
          <label id="cashLabelLabel" class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.form.label">Keterangan</label>
          <input id="cashLabel" type="text" placeholder="Misal: Peserta / Lapangan" data-i18n-placeholder="cash.form.label.placeholder" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" required />
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.form.amount">Amount</label>
            <input id="cashAmount" type="number" min="0" step="1000" value="0" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" required />
          </div>
          <div>
            <label class="text-xs text-gray-500 dark:text-gray-300" data-i18n="cash.form.pax">Pax</label>
            <input id="cashPax" type="number" min="1" step="1" value="1" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white dark:bg-gray-900 dark:border-gray-700" required />
          </div>
        </div>
        <div class="flex items-center justify-end gap-3 text-sm">
          <div><span data-i18n="cash.form.total">Total:</span> <strong id="cashTotal">Rp0</strong></div>
        </div>
        <div class="flex items-center justify-end gap-2">
          <button type="button" id="cashCancel" class="px-3 py-2 rounded-lg border dark:border-gray-700" data-i18n="cash.form.cancel">Batal</button>
          <button type="submit" class="px-3 py-2 rounded-lg bg-indigo-600 text-white" data-i18n="cash.form.save">Simpan</button>
        </div>
      </form>
    </div>
  </div>

  <div id="playerStatsModal" class="hidden fixed inset-0 z-50 flex items-start justify-center p-4">
    <div id="playerStatsOverlay" class="absolute inset-0 bg-black/50"></div>
    <div class="relative bg-white dark:bg-gray-900 rounded-xl max-w-6xl w-full overflow-auto shadow-lg" style="max-height:90vh;">
      <button id="playerStatsClose" class="absolute top-3 right-3 text-gray-700 dark:text-gray-200 bg-white/10 hover:bg-white/20 rounded-full w-9 h-9 flex items-center justify-center">✕</button>
      <div id="playerStatsContainer" class="p-4">
        <!-- content populated by scripts/event-location-public.js -->
        <div class="p-6 muted">Loading...</div>
      </div>
    </div>
  </div>

  <!-- Modal: Global Ranking -->
  <div id="globalRankingModal" class="hidden fixed inset-0 z-[60] flex items-start justify-center p-4">
    <div id="globalRankingOverlay" class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
    <div class="relative bg-white dark:bg-gray-900 rounded-2xl max-w-5xl w-full overflow-hidden shadow-2xl flex flex-col" style="max-height:90vh;">
      <div class="px-6 py-4 border-b border-gray-100 dark:border-gray-800 flex items-center justify-between bg-white dark:bg-gray-900 z-10">
        <div>
          <h3 class="text-xl font-bold text-gray-900 dark:text-white" data-i18n="ranking.title">Global Ranking</h3>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" data-i18n="ranking.subtitle">Berdasarkan statistik dari seluruh event</p>
        </div>
        <button id="globalRankingClose" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
      </div>
      <div class="flex-1 overflow-auto px-4 md:px-6 pb-6" id="globalRankingContainer">
        <div class="flex items-center justify-center py-12">
           <svg class="animate-spin h-8 w-8 text-indigo-600" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path></svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Hitung Skor -->
  <div id="scoreModal" class="fixed inset-0 z-50 hidden">
    <!-- backdrop -->
    <div class="absolute inset-0 bg-black/40"></div>
    <!-- dialog -->
    <div class="relative mx-auto mt-16 w-[92%] max-w-xl rounded-2xl bg-white dark:bg-gray-800 shadow-lg p-4 md:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg md:text-xl font-semibold"><span data-i18n="score.title">Hitung Skor –</span> <span id="scoreRoundTitle"></span></h3>
        <button id="btnCloseScore" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="score.close">Tutup</button>
      </div>

      <!-- Players info -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3">
        <div class="rounded-xl border dark:border-gray-700 p-3 text-center">
          <div class="text-xs uppercase text-gray-500 dark:text-gray-300 mb-1" data-i18n="score.teamA">Skor Tim A</div>
          <div id="scoreTeamA" class="font-medium">-</div>
          <div class="text-3xl font-bold mb-3"><span id="scoreAVal">0</span></div>
          <div class="flex justify-center gap-2" id="scoreButtonsA">
            <button id="btnAMinus" class="px-3 py-2 rounded-lg border dark:border-gray-700">−</button>
            <button id="btnAPlus"  class="px-3 py-2 rounded-lg bg-indigo-600 text-white">+</button>
          </div>
        </div>
        <div class="rounded-xl border dark:border-gray-700 p-3 text-center">
          <div class="text-xs uppercase text-gray-500 dark:text-gray-300 mb-1" data-i18n="score.teamB">Skor Tim B</div>
          <div id="scoreTeamB" class="font-medium">-</div>
          <div class="text-3xl font-bold mb-3"><span id="scoreBVal">0</span></div>
          <div class="flex justify-center gap-2" id="scoreButtonsB">
            <button id="btnBMinus" class="px-3 py-2 rounded-lg border dark:border-gray-700">−</button>
            <button id="btnBPlus"  class="px-3 py-2 rounded-lg bg-indigo-600 text-white">+</button>
          </div>
        </div>
      </div>

      <!-- Counter -->
      <!-- <div class="grid grid-cols-2 gap-3">
        <div class="rounded-2xl border dark:border-gray-700 p-3 text-center">
          <div class="text-sm mb-2">Skor Tim A</div>
          
        </div>
        <div class="rounded-2xl border dark:border-gray-700 p-3 text-center">
          <div class="text-sm mb-2">Skor Tim B</div>
          
        </div>
      </div> -->
      <div class="mt-3 flex items-center justify-center gap-3">
          <div class="text-sm text-gray-600 dark:text-gray-300" data-i18n="score.timeLeft">Waktu tersisa:</div>
          <div id="scoreTimer" class="text-2xl font-mono font-bold">--:--</div>
        </div>
      <div class="mt-4 flex flex-wrap gap-2 justify-between">
        <div class="flex gap-2" id="scoreControlsLeft">
          <button id="btnStartTimer" class="px-3 py-2 rounded-lg bg-indigo-600 text-white" data-i18n="score.start">Mulai</button>
          <!-- <button id="btnTie" class="px-3 py-2 rounded-lg border dark:border-gray-700">Set Seri</button> -->
          <button id="btnResetScore" class="px-3 py-2 rounded-lg border dark:border-gray-700" data-i18n="score.reset">Reset</button>
        </div>
        <button id="btnFinishScore" class="px-4 py-2 rounded-lg bg-emerald-600 text-white font-semibold">
          <span data-i18n="score.finish">Finish & Isi Ke Match</span>
        </button>
        <button id="btnRecalc"
                class="hidden px-4 py-2 rounded-lg bg-indigo-600 text-white font-semibold">
          <span data-i18n="score.recalc">Hitung Ulang</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Buat Event -->
  <div id="eventModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative mx-auto mt-16 w-[92%] max-w-md rounded-2xl bg-white dark:bg-gray-800 shadow p-4 md:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-semibold" data-i18n="event.title">Buat/Cari Event</h3>
        <button id="eventCancelBtn" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="event.close">Tutup</button>
      </div>
      <!-- Tabs: Buat/Cari -->
      <div class="mb-3 grid grid-cols-2 gap-2" id="eventTabs">
        <button id="tabCreateEvent" class="px-3 py-2 rounded-xl border dark:border-gray-700 bg-indigo-600 text-white font-semibold" data-i18n="event.tabCreate">Buat</button>
        <button id="tabSearchEvent" class="px-3 py-2 rounded-xl border dark:border-gray-700 dark:text-gray-100" data-i18n="event.tabSearch">Cari</button>
      </div>
      <!-- form isi nama/tanggal -->
      <div id="eventForm" class="space-y-3">
        <div>
          <label class="block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="event.name">Nama Event</label>
          <input id="eventNameInput" type="text" placeholder="Mis. Mix Americano Malam" data-i18n-placeholder="event.name.placeholder"
                class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
        </div>
        <div>
          <label class="block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="event.date">Tanggal</label>
          <input id="eventDateInput" type="date"
                class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
        </div>
        <button id="eventCreateBtn" class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white font-semibold">
          <span data-i18n="event.create">Create & Buat Link</span></button>
      </div>

      <!-- search existing event (moved from old modal) -->
      <div id="eventSearchForm" class="hidden space-y-3">
        <div>
          <label class="block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="event.date">Tanggal</label>
          <select id="searchDateSelect" class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100">
            <option value="" data-i18n="event.searchDate.placeholder">Pilih tanggal…</option>
          </select>
        </div>
        <div>
          <label class="block text-[11px] uppercase tracking-wide font-semibold text-gray-500 dark:text-gray-300" data-i18n="event.searchEvent.label">Event di tanggal tersebut</label>
          <select id="searchEventSelect" class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100">
            <option value="" data-i18n="event.searchEvent.placeholder">Pilih tanggal dulu</option>
          </select>
        </div>
        <button id="openEventBtn" class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white font-semibold" disabled>
          <span data-i18n="event.open">Buka Event</span>
        </button>
      </div>

      <!-- success message -->
      <div id="eventSuccess" class="hidden space-y-3">
        <div class="p-3 rounded-lg bg-green-50 text-green-700 text-sm border border-green-200">
          <span data-i18n="event.success">✅ Event berhasil dibuat! Bagikan link berikut:</span>
        </div>
        <div class="flex items-center gap-2">
          <input id="eventLinkOutput" readonly
                class="flex-1 border rounded-lg px-3 py-2 text-sm bg-gray-50 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100" />
          <button id="eventCopyBtn" class="px-3 py-2 rounded-lg bg-green-600 text-white text-sm" data-i18n="event.copy">Copy</button>
        </div>
      </div>
  </div>
  </div>

  <!-- Modal: Login -->
  <div id="loginModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40" id="loginBackdrop"></div>
    <div class="relative mx-auto mt-16 w-[92%] max-w-md rounded-2xl bg-white dark:bg-gray-800 shadow p-4 md:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-semibold" data-i18n="login.title">Login</h3>
        <button id="loginCancelBtn" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="login.close">Tutup</button>
      </div>
        <div class="space-y-3">
          <div class="text-sm text-gray-600 dark:text-gray-300" data-i18n="login.desc">Masukkan email Anda.</div>
          <input id="loginEmail" type="email" placeholder="email@example.com" class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
          <button id="loginSendBtn" class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white font-semibold" data-i18n="login.send">Kirim Link Login</button>
          <!-- <button id="loginSsoBtn" class="w-full mt-2 px-3 py-2 rounded-xl bg-white border text-gray-800 font-semibold" title="Login dengan SSO">Login dengan SSO</button> -->
          <div id="loginMsg" class="text-xs"></div>
        </div>
    </div>
  </div>

  <!-- Modal: Admin Login -->
  <div id="adminLoginModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40" id="adminBackdrop"></div>
    <div class="relative mx-auto mt-16 w-[92%] max-w-md rounded-2xl bg-white dark:bg-gray-800 shadow p-4 md:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-semibold" data-i18n="admin.title">Administrator Login</h3>
        <button id="adminCancelBtn" class="px-3 py-1 rounded-lg border dark:border-gray-700" data-i18n="admin.close">Tutup</button>
      </div>
      <div class="space-y-3">
        <div class="text-sm text-gray-600 dark:text-gray-300" data-i18n="admin.desc">Masukkan email dan password Anda.</div>
        <input id="adminEmail" type="email" placeholder="email@example.com" class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
        <input id="adminPass" type="password" placeholder="Password" data-i18n-placeholder="admin.password.placeholder" class="mt-1 border rounded-xl px-3 py-2 w-full bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100" />
        <button id="adminLoginBtn" class="w-full px-3 py-2 rounded-xl bg-indigo-600 text-white font-semibold" data-i18n="admin.submit">Login</button>
        <div id="adminMsg" class="text-xs"></div>
      </div>
    </div>
  </div>

  <!-- Global Loading Overlay -->
  <div id="loadingOverlay" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/30 backdrop-blur-sm"></div>
    <div class="relative mx-auto mt-28 w-[92%] max-w-sm rounded-2xl bg-white dark:bg-gray-800 shadow p-5 flex flex-col items-center gap-3">
      <svg class="animate-spin h-7 w-7 text-indigo-600" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
      </svg>
      <div id="loadingText" class="text-sm text-gray-700 dark:text-gray-200" data-i18n="loading.text">Memproses…</div>
    </div>
  </div>


  <!-- <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script> -->
  <!-- Supabase SDK dari CDN -->
  <script src="config.js"></script>
  <!-- <script src="https://unpkg.com/@supabase/supabase-js@2"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script> -->
   <script src="supabase/js/supabase.min.js"></script>
  <script id="supabase-init">
    (function initSupabase(){
      const SUPABASE_URL  = window.__SUPABASE_URL;
      const SUPABASE_ANON = window.__SUPABASE_ANON;
      if (!SUPABASE_URL || !SUPABASE_ANON){
        console.error('[Supabase] URL/Anon key belum dikonfigurasi di config.js');
        return;
      }
      if (!window.supabase || typeof window.supabase.createClient !== 'function') {
        console.error('[Supabase] global client library belum siap');
        return;
      }
      window.sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON);
      console.log('[Supabase] client ready:', !!window.sb);
      try {
        window.dispatchEvent(new CustomEvent('supabase-ready', { detail: window.sb }));
      } catch (err) {
        console.warn('[Supabase] gagal dispatch supabase-ready event', err);
      }
    })();
  </script>
  <script src="scripts/helpers.js?v=2025-08-29"></script>
  <script src="scripts/join-open.js?v=2025-08-29"></script>
  <script src="scripts/storage.js?v=2025-08-29"></script>
  <script src="scripts/event-controls.js?v=2025-08-29"></script>
  <script src="scripts/event-location-public.js?v=2025-08-29"></script>
  <script src="scripts/title-rename.js?v=2025-08-29"></script>
  <script src="scripts/auth-redirect.js?v=2025-08-29"></script>
  <script src="scripts/auth-core.js?v=2025-08-29"></script>
  <script src="scripts/join-event.js?v=2025-08-29"></script>
  <script src="scripts/toast.js?v=2025-08-29"></script>
  <script src="scripts/delta-updates.js?v=2025-08-29"></script>
  <script src="scripts/autosave.js?v=2025-08-29"></script>
  <script src="scripts/state.js?v=2025-08-29"></script>
  <script src="scripts/player-meta.js?v=2025-08-29"></script>
  <script src="scripts/access-control.js?v=2025-08-29"></script>
  <script src="scripts/theme.js?v=2025-08-29"></script>
  <script src="scripts/settings-popup.js?v=2025-10-12"></script>
  <script src="scripts/sessions.js?v=2025-08-29"></script>
  <script src="scripts/players-ui.js?v=2025-08-29"></script>
  <script src="scripts/editor-panel.js?v=2025-08-29"></script>
  <script src="scripts/max-players.js?v=2025-08-29"></script>
  <script src="scripts/event-location-editor.js?v=2025-08-29"></script>
  <script src="scripts/americano.js?v=2025-08-29"></script>
  <script src="scripts/rename-helpers.js?v=2025-08-29"></script>
  <script src="scripts/courts.js?v=2025-08-29"></script>
  <script src="scripts/rendering.js?v=2025-08-29"></script>
  <script src="scripts/auto-fill.js?v=2025-08-29"></script>
  <script src="scripts/score-modal.js?v=2025-10-15"></script>
  <script src="scripts/tennis-score-modal.js?v=2025-10-15" type="module"></script>
  <script src="scripts/filter-toggle.js?v=2025-08-29"></script>
  <script src="scripts/auth-ui.js?v=2025-08-29"></script>
  <script src="scripts/standings-export.js?v=2025-08-29"></script>
  <script src="scripts/player-composition-info.js?v=2025-09-26"></script>
  <script src="scripts/match-recap.js?v=2025-09-22"></script>
  <script src="scripts/global-ranking.js?v=2026-01-13"></script>
  <script src="scripts/pwa-install.js"></script>
  <script src="scripts/cashflow.js" type="module"></script>
  <script src="app.js?v=2025-08-29"></script>
  <script src="app-responsive-addon.js?v=2025-08-29"></script>
  <script src="scripts/mobile-nav.js" type="module"></script>
  <script>
    // Toggle action menu pada header pemain (mobile)
    (function(){
      const toggle = document.getElementById('playersActionsToggle');
      const menu = document.getElementById('playersActions');
      if (!toggle || !menu) return;
      const isDesktop = () => window.matchMedia && window.matchMedia('(min-width: 768px)').matches;
      const closeMenu = () => { if (isDesktop()) return; menu.classList.add('hidden'); menu.classList.remove('flex'); };
      toggle.addEventListener('click', (e) => {
        if (isDesktop()) return;
        e.stopPropagation();
        const open = !menu.classList.contains('hidden');
        if (open) { closeMenu(); return; }
        menu.classList.add('flex');
        menu.classList.remove('hidden');
      });
      document.addEventListener('click', (e) => {
        if (isDesktop()) return;
        if (!menu.contains(e.target) && e.target !== toggle) closeMenu();
      });
      window.addEventListener('resize', () => {
        if (isDesktop()) { menu.classList.remove('hidden'); menu.classList.remove('flex'); }
        else { closeMenu(); }
      });
    })();
  </script>
  <script>
    (function(){
      function hide(){ try{ var el=document.getElementById('appSplash'); if(!el) return; el.classList.add('hide'); setTimeout(function(){ try{ el.remove(); }catch{} }, 420); }catch{} }
      if (document.readyState === 'complete') setTimeout(hide, 120);
      else window.addEventListener('load', function(){ setTimeout(hide, 150); });
      try{ window.hideAppSplash = hide; }catch{}
    })();
  </script>
</body>
</html>




